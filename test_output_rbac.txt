================================================================================
ROLE-BASED ACCESS CONTROL TEST SUITE
================================================================================
Test Run: 2026-01-23 12:59:35

✓ Loaded semantic registry successfully

================================================================================
ROLE-BASED ACCESS CONTROL REPORT
================================================================================

METRIC ACCESS POLICIES:
--------------------------------------------------------------------------------
Total Metrics: 23
Metrics with Policies: 23
Metrics without Policies: 0

--------------------------------------------------------------------------------
ROLE ACCESS MATRIX
--------------------------------------------------------------------------------

PUBLIC Role:
  Allowed Metrics: 20/23
  Denied Metrics: 3/23
  Sample Allowed: tos, pos, active_users, total_account_balance, transaction_volume
    ... and 15 more

ANALYST Role:
  Allowed Metrics: 20/23
  Denied Metrics: 3/23
  Sample Allowed: tos, pos, active_users, total_account_balance, transaction_volume
    ... and 15 more

FINANCE Role:
  Allowed Metrics: 22/23
  Denied Metrics: 1/23
  Sample Allowed: tos, pos, total_account_balance, transaction_volume, transaction_count
    ... and 17 more

ADMIN Role:
  Allowed Metrics: 23/23
  Denied Metrics: 0/23
  Sample Allowed: tos, pos, active_users, total_account_balance, transaction_volume
    ... and 18 more

--------------------------------------------------------------------------------
SENSITIVE METRICS (Finance/Admin Only)
--------------------------------------------------------------------------------

  writeoff_amount:
    Roles: finance, admin
    Description: Total writeoff amount

  interest_accrued:
    Roles: finance, admin
    Description: Total interest accrued

  penalty_waived:
    Roles: finance, admin
    Description: Total penalty waived amount

--------------------------------------------------------------------------------
POLICY CONSTRAINTS
--------------------------------------------------------------------------------
Metrics with Time Range Limits: 19
Metrics with Row Limits: 19
Metrics with Dimension Limits: 21

================================================================================
USER ACCESS SCENARIOS
================================================================================

PUBLIC User Scenarios:
  ✓ 'What is the total outstanding amount?' -> Access GRANTED for tos
  ✓ 'Show me the transaction volume' -> Access GRANTED for active_users
  ✓ 'What is the writeoff amount?' -> Access GRANTED for active_users

ANALYST User Scenarios:
  ✓ 'What is the total outstanding amount?' -> Access GRANTED for tos
  ✓ 'Show transaction volume by date' -> Access GRANTED for transaction_volume
  ✓ 'What is the writeoff amount?' -> Access GRANTED for active_users

FINANCE User Scenarios:
  ✓ 'What is the total outstanding amount?' -> Access GRANTED for tos
  ✓ 'Show me the writeoff amount' -> Access GRANTED for tos
  ✓ 'What is the interest accrued?' -> Access GRANTED for tos

ADMIN User Scenarios:
  ✓ 'What is the total outstanding amount?' -> Access GRANTED for tos
  ✓ 'Show me the writeoff amount' -> Access GRANTED for tos
  ✓ 'What is the penalty waived?' -> Access GRANTED for active_users

✓ Test results saved to: /Users/niyathnair/Desktop/Task/RCA-ENGINE/rbac_test_results.json

✓ RBAC test completed!
