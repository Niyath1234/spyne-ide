# RAG Retrieval Configuration
# Fine-tune RAG retrieval parameters for optimal performance

# Schema RAG Configuration
schema_rag:
  # Number of top-K schemas to retrieve
  top_k: 10
  
  # Minimum similarity threshold (0.0 to 1.0)
  # Results below this threshold will be filtered out
  similarity_threshold: 0.6
  
  # Embedding model configuration
  embedding:
    # Model to use for embeddings
    model: "text-embedding-3-small"
    
    # Batch size for embedding generation
    batch_size: 32
    
    # Maximum retries for embedding API calls
    max_retries: 3

# Document Retrieval RAG Configuration
document_rag:
  # Initial retrieval count (hybrid search)
  top_k_retrieval: 20
  
  # Final chunks after reranking
  top_k_rerank: 5
  
  # Hybrid search alpha parameter
  # 0.0 = pure sparse (keyword) search
  # 1.0 = pure dense (semantic) search
  # 0.7 = balanced (recommended)
  alpha: 0.7
  
  # Reranking model
  rerank_model: "rerank-english-v3.0"
  
  # Minimum rerank score threshold
  rerank_threshold: 0.5
  
  # Document type filters
  document_types:
    - "ARD"
    - "PRD"
    - "TRD"
  
  # Chunk size for document splitting
  chunk_size: 512
  
  # Chunk overlap
  chunk_overlap: 50

# Vector Store Configuration
vector_store:
  # Similarity metric
  # Options: cosine, euclidean, dot_product
  similarity_metric: "cosine"
  
  # Index type
  # Options: flat, ivf, hnsw
  index_type: "hnsw"
  
  # HNSW parameters (if using HNSW index)
  hnsw:
    m: 16
    ef_construction: 200
    ef_search: 50

# Performance Tuning
performance:
  # Enable caching for frequent queries
  enable_cache: true
  
  # Cache TTL in seconds
  cache_ttl: 3600
  
  # Maximum cache size (number of entries)
  max_cache_size: 1000
  
  # Parallel retrieval (number of parallel requests)
  parallel_requests: 4
  
  # Timeout for retrieval operations (seconds)
  timeout: 30

# Monitoring and Logging
monitoring:
  # Enable detailed logging
  enable_logging: true
  
  # Log level: debug, info, warning, error
  log_level: "info"
  
  # Log file path (relative to project root)
  log_file: "logs/rag_retrieval.log"
  
  # Enable metrics collection
  enable_metrics: true
  
  # Metrics export interval (seconds)
  metrics_interval: 60

# Query Optimization
query_optimization:
  # Enable query expansion
  enable_expansion: true
  
  # Maximum expansion terms
  max_expansion_terms: 3
  
  # Enable query rewriting
  enable_rewriting: true
  
  # Boost factors for different document types
  boost_factors:
    ARD: 1.2
    PRD: 1.1
    TRD: 1.0
  
  # Boost factors for metadata fields
  metadata_boost:
    title: 2.0
    headers: 1.5
    reference_id: 1.3
    project: 1.2

# Environment-specific overrides
environments:
  development:
    top_k_retrieval: 10
    top_k_rerank: 3
    enable_cache: false
    log_level: "debug"
  
  production:
    top_k_retrieval: 20
    top_k_rerank: 5
    enable_cache: true
    log_level: "info"
    similarity_threshold: 0.7

